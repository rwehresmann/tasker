<div id="<%= dom_id(task) %>" class="list-group-item d-flex justify-content-between <%= 'incomplete' unless task.complete? %>" data-controller="task" data-id="<%= task.to_sgid.to_s %>" data-task-incomplete-class="incomplete">
  <div class="custom-control custom-checkbox" data-task-target="checkbox">
    <input type="checkbox" class="custom-control-input" id="<%= dom_id(task) %>_checkbox" data-reflex="change->TaskReflex#toggle" data-id="<%= task.to_sgid.to_s %>" <%= 'checked' if task.complete? %>>
    <label for="<%= dom_id(task) %>_checkbox" class="custom-control-label">
      <% if task.complete? %>
        <del>
          <%= task.name %>
          <% if task.completer %>
            <span class="text-muted">Completed by <%= task.completer_name %></span>
          <% end %>  
        </del>
      <% else %>
        <%= task.name %>
        <span class="text-muted" id="task-<%= task.id %>-assignee"><%= task.assignee_name %></span>
      <% end %>
    </label>
  </div>
  
  <div class="collapse mt-2" id="collapse-<%= task.id %>" data-task-target="collapse">
    <%= bootstrap_form_with model: task, url: '', layout: :inline, html: { class: 'mb-2' }, data: { reflex: "submit->Task#update", id: task.to_sgid.to_s } do |form| %>
      <%= form.text_field :name, skip_label: true, class: 'mr-2', id: "task_name_#{task.id}" %>
      <%= form.primary 'update' %>
    <% end %>
    
    <%= select_tag :assignee, options_from_collection_for_select(team.users, :id, :name, task.assignee_id), prompt: "Assign user", class: "custom-select", data: { reflex: "change->Task#assign", id: task.to_sgid.to_s } %>
  </div>

  <div class="d-flex align-items-center">
    <%= link_to list_task_path(task.list, task), class: "mr-2" do %>
      <i class="fa fa-comments text-secondary"></i>
    <% end %>
    
    <a href="#collapse-<%= task.id %>" data-toggle="collapse" class="mr-2">
      <i class="fa fa-edit text-primary"></i>
    </a>
    <i class="fa fa-times text-danger" data-action="click->task#destroy" data-id="<%= task.to_sgid.to_s %>" style="cursor: pointer"></i>
  </div>
</div>
